#!/bin/bash

# Pre-commit hook for manus-go
# This hook runs formatting and linting before each commit

set -e

echo "Running pre-commit checks..."

# Run format
echo "→ Formatting code..."
if ! make format; then
    echo "❌ Formatting failed. Please fix the issues and try again."
    exit 1
fi

# Run lint
echo "→ Running linter..."
if ! make lint; then
    echo "❌ Linting failed. Please fix the issues and try again."
    exit 1
fi

# Check if formatting made changes
if ! git diff --quiet; then
    echo "⚠️  Formatting made changes. Please review and stage them:"
    git diff --name-only
    echo ""
    echo "Run: git add <files> && git commit"
    exit 1
fi

echo "✅ Pre-commit checks passed!"
exit 0